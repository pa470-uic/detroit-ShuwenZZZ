---
title: "Part 1"
author: "Shuwen Zhang"
output: 
  html_document:
    code_folding: hide
    df_print: paged
    theme: sandstone
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(RSQLite)
```

Template file. Code will be included in folded blocks in the output to facilitate grading. Please knit this file and commit both the rmd and the html output. If you add external files to your analysis, please commit them to the files folder in this repository. NOTE: please do not commit large (15MB+) files to GitHub. Instead please denote the origin of the files in your code. 

```{r}
#example connection to database. note that you have to download the database from onedrive
setwd("~/Library/Group Containers/UBF8T346G9.OneDriveSyncClientSuite/OneDrive - University of Illinois at Chicago.noindex/OneDrive - University of Illinois at Chicago/UIC semesters/2022 Spring/PA470 AI & Machine Learning/Detroit Project/PA470_Detroit_Project/detroit-ShuwenZZZ")
con <- DBI::dbConnect(RSQLite::SQLite(), "/Users/shuwenzhang/Library/Group Containers/UBF8T346G9.OneDriveSyncClientSuite/OneDrive - University of Illinois at Chicago.noindex/OneDrive - University of Illinois at Chicago/UIC semesters/2022 Spring/PA470 AI & Machine Learning/Detroit Project/PA470_Detroit_Project/detroit-ShuwenZZZ/database/detroit.sqlite")

# sales tbl

dplyr::tbl(con, 'sales')

# convert to tibble and save it as con1
con1<-dplyr::tbl(con, 'sales') %>% dplyr::collect()

# sql query

dplyr::tbl(con, 'sales') %>% count(year(sale_date))

#dplyr::tbl(con, 'sales') %>% count(year(sale_date)) %>% show_query()

```
Section A: Conduct an exploratory data analysis of homes in Detroit. Offer an overview of relevant trends in the data and data quality issues. Contextualize your analysis with key literature on properties in Detroit.

```{r}

# Set the date data
con1$sale_date <- con1 %>% dplyr::mutate(sale_date=ymd(sale_date))


```

Section B: Use cmfproperty to conduct a sales ratio study across the relevant time period. Note that cmfproperty is designed to produce Rmarkdown reports but use the documentation and insert relevant graphs/figures into your report. Look to make this reproducible since you’ll need these methods to analyze your assessment model later on. Detroit has many sales which are not arm’s length (sold at fair market value) so some sales should be excluded, but which ones?

```{r}
# Use cmfproperty
#install.packages("devtools")
devtools::install_github("cmf-uchicago/cmfproperty")
library(cmfproperty)


```







